# RAG-Агент по ГОСТ Р 58669-2019

AI-агент на основе Retrieval-Augmented Generation (RAG) для ответа на вопросы по стандарту ГОСТ Р 58669-2019 "Единая энергетическая система и изолированно работающие энергосистемы. Релейная защита и автоматика. Трансформаторы тока измерительные. Требования к характеристикам намагничивания и методам их определения".

## Возможности

- Загрузка и обработка PDF-документов из папки `files/`
- Разделение текста на чанки для точности
- Векторное хранение с использованием FAISS
- Ответы на основе контекста с помощью модели Ollama (Qwen3:8b)
- Интерактивный чат в консоли

## Требования

- Python 3.8+
- Ollama (для запуска локальной модели)

## Установка

1. Установите зависимости:
   ```
   pip install -r requirements.txt
   ```

2. Скачайте модель через Ollama:
   ```
   ollama pull qwen3:8b
   ```

3. Запустите Ollama сервер (в отдельном терминале):
   ```
   ollama serve
   ```

## Использование

### Быстрый запуск с перестройкой индекса
Запустите файл `run.ps1` (для Windows) или:
```
rem очищает индекс и запускает python main.py
```

### Консольный интерфейс
Запустите:
```
python main.py
```
При первом запуске система автоматически обработает PDF-файлы из папки `files/` и создаст векторный индекс.

Взаимодействие: Выберите режим 1 (Поиск) или 2 (Генерация ТТ), введите запрос.

Примеры вопросов:
- "Как определить точку насыщения трансформатора тока?"
- "Расскажи о методах расчета коэффициента насыщения"
- "Какие требования к вторичной нагрузке?"

Для выхода введите "exit".

### Веб-интерфейс
Запустите:
```
streamlit run app.py
```
Откроется веб-приложение с интерфейсом для поиска и генерации ТТ.

## Структура проекта

- `main.py` - основной скрипт агента (интерфейс выбора режима)
- `search_handler.py` - модуль для поиска информации по нормативам
- `tt_handler.py` - модуль для генерации технических требований
- `app.py` - веб-интерфейс с Streamlit
- `requirements.txt` - зависимости Python
- `run.ps1` - скрипт запуска с очисткой индекса
- `faiss_index/` - векторный индекс (создается автоматически)
- `files/` - папка с PDF и TXT документами

## Технические детали

- Эмбеддинги: `sentence-transformers/all-MiniLM-L6-v2`
- Размер чанка: 500 символов с перекрытием 100
- Поиск: MMR с k=10
- Температура модели: 0.0 для точных ответов
- Ограничение ответа: не более 200 токенов

## Конфигурация

Для изменения параметров модели или промпта отредактируйте `main.py`:
- Имя модели Ollama: `qwen3:8b`
- Размер чанка и перекрытие в `RecursiveCharacterTextSplitter`
- Шаблон промпта в `setup_rag_chain`
